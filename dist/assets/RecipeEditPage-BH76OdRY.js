import{r,D as le,j as e,E as ce,G as qe,H as ue,_ as de,J as Re,K as $e,L as we,N as Pe,R as Le,T as me,O as Oe,P as D,o as g,Q,B as $,F as P,U as pe,V as te,W as H,S as Z,l as ae,X as K,Y as Te,Z as ze,I as V,e as J,f as A,$ as be,a0 as De,M as B,d as ne,a1 as Fe,c as _e,a2 as he,k as se,a3 as G,u as Ee,y as Ke,a4 as Ue,n as Me,p as Qe,s as Ge,z as Ae,t as Ve,m as Be,i as He,a5 as Ze,v as E,a6 as M,a7 as L,x as O}from"./index-Djf207zA.js";import{u as Y}from"./useMutation-CYG_XA4X.js";const W=r.forwardRef(({className:t,bsPrefix:n,as:a="span",...s},o)=>(n=le(n,"input-group-text"),e.jsx(a,{ref:o,className:ce(t,n),...s})));W.displayName="InputGroupText";const Je=t=>e.jsx(W,{children:e.jsx(ue,{type:"checkbox",...t})}),We=t=>e.jsx(W,{children:e.jsx(ue,{type:"radio",...t})}),ge=r.forwardRef(({bsPrefix:t,size:n,hasValidation:a,className:s,as:o="div",...l},d)=>{t=le(t,"input-group");const c=r.useMemo(()=>({}),[]);return e.jsx(qe.Provider,{value:c,children:e.jsx(o,{ref:d,...l,className:ce(s,t,n&&`${t}-${n}`,a&&"has-validation")})})});ge.displayName="InputGroup";const ye=Object.assign(ge,{Text:W,Radio:We,Checkbox:Je});function Xe(){const[,t]=r.useReducer(n=>n+1,0);return t}var Ye=["allowNew","delay","isLoading","minLength","onInputChange","onSearch","options","useCache"];function ie(t,n){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);n&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),a.push.apply(a,s)}return a}function oe(t){for(var n=1;n<arguments.length;n++){var a=arguments[n]!=null?arguments[n]:{};n%2?ie(Object(a),!0).forEach(function(s){we(t,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ie(Object(a)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(a,s))})}return t}function et(t){var n=t.allowNew,a=t.delay,s=a===void 0?200:a,o=t.isLoading,l=t.minLength,d=l===void 0?2:l,c=t.onInputChange,u=t.onSearch,p=t.options,x=p===void 0?[]:p,k=t.useCache,b=k===void 0?!0:k,f=de(t,Ye),y=r.useRef({}),i=r.useRef(null),m=r.useRef(t.defaultInputValue||""),w=Xe(),q=Re(t),T=r.useCallback(function(N){if(m.current=N,!(!N||d&&N.length<d)){if(b&&y.current[N]){w();return}u(N)}},[w,d,u,b]);r.useEffect(function(){return i.current=$e(T,s),function(){i.current&&i.current.cancel()}},[s,T]),r.useEffect(function(){!o&&q&&q.isLoading&&b&&(y.current[m.current]=x)});var z=r.useCallback(function(N){var X=N.target.value;c&&c(N),i.current&&i.current(X)},[c]),S=y.current[m.current];return oe(oe({},f),{},{allowNew:Pe(n)?n:n&&!o,isLoading:o,minLength:d,onInputChange:z,options:b&&S?S:x,query:m.current})}var tt=["query"],at=r.forwardRef(function(t,n){var a=t.emptyLabel,s=t.isLoading,o=t.promptText,l=o===void 0?"Type to search...":o,d=t.searchText,c=d===void 0?"Searching...":d,u=et(t),p=u.query,x=de(u,tt);function k(){return p.length?s?c:a:l}return Le.createElement(me,Oe({},t,x,{emptyLabel:k(),ref:n}))});const ee=t=>{var l,d;const n=r.useId(),{register:a,formState:{errors:s}}=D(),o=(d=(l=s[t.name])==null?void 0:l.message)==null?void 0:d.toString();return e.jsxs(g.Group,{className:`mb-3 ${t.className??""}`,controlId:`${n}_${t.name}`,children:[e.jsx(g.Label,{children:t.label}),e.jsx(g.Control,{...a(t.name),as:"textarea",name:t.name,disabled:t.disabled,isInvalid:!!o,rows:t.rows}),e.jsx(g.Control.Feedback,{type:"invalid",children:o})]})},nt=t=>{var u;const n=r.useId(),{register:a,formState:{errors:s},getValues:o,setValue:l}=D(),d=(u=Q.get(s,t.name))==null?void 0:u.message,c=o(t.name);return r.useEffect(()=>{t.multiple?Array.isArray(c)?l(t.name,c.filter(p=>!!p).map(p=>p.toString())):c!=null&&c.toString().trim()!==""?l(t.name,[c.toString()]):l(t.name,[]):l(t.name,c!=null&&c.toString().trim()!==""?c.toString():"-1")},[c,t.multiple,t.name,l]),e.jsxs(g.Group,{className:"mb-3",controlId:`${n}_${t.name}`,children:[e.jsx(g.Label,{children:t.label}),e.jsxs(g.Select,{...a(t.name),disabled:t.disabled,multiple:t.multiple,isInvalid:!!d,children:[!t.multiple&&e.jsx("option",{value:"-1",disabled:!0,children:"Prosím zvolte možnosť"}),t.options.map(p=>"options"in p?e.jsx("optgroup",{label:p.optGroupName,children:p.options.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))},p.optGroupId):e.jsx("option",{value:p.value,children:p.label},p.value))]}),e.jsx(g.Control.Feedback,{type:"invalid",children:d==null?void 0:d.toString()})]})},rt=({index:t,move:n,name:a,remove:s,units:o})=>{var q,T,z;const{register:l,formState:{errors:d}}=D(),c=r.useId(),[u,p]=r.useState(!1),x=r.useCallback(S=>{S.dataTransfer.clearData(),u&&(S.dataTransfer.setData("position",t.toString()),S.dataTransfer.dropEffect="move")},[u,t]),k=r.useCallback(S=>{S.preventDefault()},[]),b=r.useCallback(S=>{const N=+S.dataTransfer.getData("position");n(N,t)},[t,n]),f=(q=Q.get(d,`${a}.name`))==null?void 0:q.message,y=(T=Q.get(d,`${a}.value`))==null?void 0:T.message,i=(z=Q.get(d,`${a}.unitId`))==null?void 0:z.message,m=r.useCallback(()=>{p(!0)},[]),w=r.useCallback(()=>{p(!1)},[]);return e.jsxs("section",{children:[e.jsx("input",{...l(`${a}.id`),type:"hidden"}),e.jsxs(ye,{className:"mb-2 ",onDragStart:x,onDragOver:k,onDrop:b,draggable:u,children:[e.jsx($,{variant:"outline-secondary",title:"Presunúť ingredienciu",type:"button",className:"mcb-ingredient-handle",onMouseOver:m,onMouseOut:w,onTouchStart:m,onTouchEnd:w,children:e.jsx(P,{icon:pe})}),e.jsx(g.Control,{...l(`${a}.name`),"aria-label":"Názov suroviny",placeholder:"Názov",type:"text",className:"mcb-ingredient-name",isInvalid:!!f,id:`${c}_name`}),e.jsx(g.Control,{...l(`${a}.value`),"aria-label":"Množstvo suroviny",placeholder:"Množstvo",type:"number",className:"mcb-ingredient-volume",isInvalid:!!y,id:`${c}_value`,min:0}),e.jsxs(g.Select,{...l(`${a}.unitId`),"aria-label":"Jednotka",name:`${a}.unitId`,className:"mcb-ingredient-unit",isInvalid:!!i,id:`${c}_unitId`,children:[e.jsx("option",{disabled:!0,value:"-1",children:"Vyberte Jednotku"}),o.map(S=>e.jsx("optgroup",{label:S.optGroupName,children:S.options.map(N=>e.jsx("option",{value:N.value,children:N.label},N.value))},S.optGroupId))]}),e.jsx($,{variant:"outline-danger","aria-label":"vymazať ingredienciu",type:"button",onClick:()=>s(t),className:"mcb-ingredient-delete",children:e.jsx(P,{icon:te})})]}),(f||y||i)&&e.jsxs("ul",{children:[f&&e.jsx("li",{className:"text-danger",children:e.jsx("label",{htmlFor:`${c}_name`,children:f==null?void 0:f.toString()})}),y&&e.jsx("li",{className:"text-danger",children:e.jsx("label",{htmlFor:`${c}_value`,children:y==null?void 0:y.toString()})}),i&&e.jsx("li",{className:"text-danger",children:e.jsx("label",{htmlFor:`${c}_unitId`,children:i==null?void 0:i.toString()})})]})]})},st=t=>{const{control:n}=D(),{fields:a,append:s,remove:o,move:l}=H({name:`${t.recipeSectionName}.ingredients`,keyName:"_id",control:n});return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{direction:"horizontal",gap:3,children:[e.jsx(g.Label,{children:"Suroviny"}),e.jsx($,{"aria-label":"pridať ingredienciu",variant:"outline-success",type:"button",className:"border-0",onClick:()=>s({name:"",sortNumber:a.length+1,value:null,unitId:-1}),children:e.jsx(P,{icon:ae})})]}),a.map((d,c)=>e.jsx(rt,{name:`${t.recipeSectionName}.ingredients.${c}`,index:c,units:t.units,move:l,remove:o},d._id))]})},it=t=>{const{register:n,control:a}=D(),{fields:s,append:o,remove:l,move:d}=H({name:"recipeSections",keyName:"_id",control:a});return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{direction:"horizontal",gap:3,children:[e.jsx(g.Label,{children:"Sekcie"}),e.jsx($,{"aria-label":"pridať sekciu",variant:"outline-success",type:"button",className:"border-0",onClick:()=>o({name:"",method:null,ingredients:[{name:"",value:null,unitId:-1,sortNumber:1}],sortNumber:s.length+1}),children:e.jsx(P,{icon:ae})})]}),s.map((c,u,p)=>e.jsx(K,{className:"mb-3",children:e.jsx(K.Body,{className:"pb-0",children:e.jsxs("section",{children:[e.jsxs("div",{className:"position-absolute mcb-card-action-btn",children:[e.jsx($,{variant:"outline-light","aria-label":"presunúť sekciu nahor",type:"button",onClick:()=>d(u,u-1),className:"border-0",disabled:u===0,children:e.jsx(P,{className:"text-dark",icon:Te})}),e.jsx($,{variant:"outline-light","aria-label":"presunúť sekciu nadol",type:"button",onClick:()=>d(u,u+1),className:"border-0",disabled:u===p.length-1,children:e.jsx(P,{className:"text-dark",icon:ze})}),e.jsx($,{"aria-label":"vymazať sekciu",variant:"outline-danger",type:"button",onClick:()=>l(u),className:"border-0",children:e.jsx(P,{icon:te})})]}),e.jsx("input",{...n(`recipeSections.${u}.id`),type:"hidden"}),e.jsx(V,{name:`recipeSections.${u}.name`,label:"Názov sekcie",className:"col-12"}),e.jsx(st,{units:t.units,recipeSectionName:`recipeSections.${u}`}),e.jsx(ee,{rows:10,className:"mt-3",label:"Postup prípravy sekcie",name:`recipeSections.${u}.method`})]})})},c._id))]})},ot=t=>{var l;const{register:n,formState:{errors:a}}=D(),s=r.useId(),o=(l=Q.get(a,t.name))==null?void 0:l.message;return e.jsxs(ye,{className:"mt-1 mb-1",children:[e.jsx(g.Control,{...n(t.name),id:`${s}_${t.name}`,type:t.type??"text",disabled:t.disabled,autoComplete:t.autoComplete,placeholder:t.placeholder,isInvalid:!!o}),e.jsx($,{variant:t.button.variant??"outline-secondary",onClick:t.onClick,type:"button",title:t.button.label,"aria-label":t.button.label,style:t.button.style,children:t.button.children}),e.jsx(g.Control.Feedback,{type:"invalid",children:o==null?void 0:o.toString()})]})},lt={label:"Odstrániť zdroj",children:e.jsx(P,{icon:te}),variant:"outline-danger",style:{borderRightColor:"rgba(0, 0, 0, 0.175)",borderTopColor:"rgba(0, 0, 0, 0.175)",borderBottomColor:"rgba(0, 0, 0, 0.175)",borderLeftColor:"rgba(0, 0, 0, 0)",borderTopRightRadius:"0.375rem",borderBottomRightRadius:"0.375rem"}},ct=()=>{const{control:t}=D(),{fields:n,append:a,remove:s}=H({name:"sources",keyName:"_id",control:t});return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{direction:"horizontal",gap:3,children:[e.jsx(g.Label,{children:"Zdroj receptu"}),e.jsx($,{"aria-label":"pridať zdroj receptu",variant:"outline-success",type:"button",className:"border-0",onClick:()=>a({value:""}),children:e.jsx(P,{icon:ae})})]}),n.length>0&&e.jsx(K,{className:"mb-3",children:e.jsx(K.Body,{children:n.map((o,l)=>e.jsx("section",{children:e.jsx(ot,{name:`sources.${l}.value`,placeholder:"Url",button:lt,onClick:()=>s(l)})},o._id))})})]})},ut=({remove:t,move:n,field:a,index:s})=>{const[o,l]=r.useState(!1),[d,c]=r.useState(),u=J();r.useEffect(()=>{let i;return(async()=>{const m=await u.fetchQuery({queryKey:["thumbnails",a.id],queryFn:async({queryKey:w})=>be.getPictureThumbnail(w[1])});m instanceof Blob&&(i=URL.createObjectURL(m),c(i))})(),()=>{i&&URL.revokeObjectURL(i)}},[a.id,u]);const p=r.useCallback(i=>{i.dataTransfer.clearData(),o&&(i.dataTransfer.setData("position",s.toString()),i.dataTransfer.dropEffect="move")},[o,s]),x=r.useCallback(i=>{i.preventDefault()},[]),k=r.useCallback(i=>{const m=+i.dataTransfer.getData("position");n(m,s)},[n,s]),b=r.useCallback(async(i,m)=>{t(i),u.removeQueries({queryKey:["thumbnails",a.id]}),u.removeQueries({queryKey:["pictures",a.id]}),m&&URL.revokeObjectURL(m)},[a.id,u,t]),f=r.useCallback(()=>{l(!0)},[]),y=r.useCallback(()=>{l(!1)},[]);return e.jsx(Fe,{children:e.jsxs(K,{onDragStart:p,onDragOver:x,onDrop:k,draggable:o,children:[e.jsx(K.Img,{variant:"top",src:d,alt:a.name,className:"mcb-card-img"}),e.jsx($,{title:"Vymazať obrázok",variant:"outline-danger",type:"button",onClick:b.bind(null,s,d),className:"position-absolute border-0 mcb-card-action-btn",children:e.jsx(P,{icon:_e})}),e.jsx($,{title:"Presunúť obrázok",variant:"outline-secondary",type:"button",className:"position-absolute border-0 mcb-card-handle",onMouseOver:f,onMouseOut:y,onTouchStart:f,onTouchEnd:y,children:e.jsx(P,{icon:pe})}),e.jsx(K.Body,{className:"pb-0",children:e.jsx(V,{name:`pictures.${s}.name`,type:"text",label:"názov obrázka"})})]})})},dt=()=>{const{control:t}=D(),{fields:n,append:a,remove:s,move:o}=H({name:"pictures",keyName:"_id",control:t}),l=r.useRef(null),[d,c]=r.useState(),u=J(),{mutate:p,isPending:x}=Y({mutationFn:b=>be.uploadPicture(b),onMutate:async()=>{await u.cancelQueries({queryKey:["thumbnails"]}),await u.cancelQueries({queryKey:["pictures"]})},onSettled:(b,f)=>{f?A(f).then(y=>c(y)):b&&(u.removeQueries({queryKey:["thumbnails",b.id]}),u.removeQueries({queryKey:["pictures",b.id]}),a({id:b.id,name:"fotografia",sortNumber:n.length+1}),l.current&&(l.current.value=""))}}),k=b=>{b.target.files&&b.target.files.length===1&&p(b.target.files[0])};return e.jsxs(e.Fragment,{children:[e.jsxs(g.Group,{controlId:"pictureUpload",className:"mb-3",children:[e.jsx(g.Label,{children:"Pridajte obrázok"}),e.jsx(g.Control,{type:"file",accept:"image/jpeg",onChange:k,ref:l})]}),e.jsx(De,{xs:1,sm:2,lg:4,className:"g-4 pb-4",children:n.map((b,f)=>e.jsx(ut,{field:b,move:o,remove:s,index:f},b.id))}),e.jsx(B,{show:!!d,message:d,type:"error",onClose:()=>{c(void 0)}}),e.jsx(ne,{show:x})]})},mt=()=>{var f;const t=r.useId(),[n,a]=r.useState(!1),[s,o]=r.useState(),[l,d]=r.useState([]),c=J(),{control:u,formState:{errors:p}}=D(),x=async y=>{try{a(!0);const i={search:y,categoryId:null,tags:[],page:0,pageSize:5,orderBy:se.RecipeSearchCriteria.OrderByEnum.Name,order:se.RecipeSearchCriteria.OrderEnum.ASC},w=(await c.fetchQuery({queryKey:["find",i],queryFn:async({queryKey:q,signal:T})=>G.findRecipe(q[1],{signal:T})})).rows.map(q=>({name:q.name,id:q.id}));d(w)}catch(i){A(i).then(m=>o(m))}finally{a(!1)}},k=(f=Q.get(p,"associatedRecipes"))==null?void 0:f.message,b=()=>!0;return e.jsxs(e.Fragment,{children:[e.jsxs(g.Group,{className:"mt-2 mb-3",children:[e.jsx(g.Label,{htmlFor:`${t}associatedRecipes`,children:"Súvisiace recepty"}),e.jsx(he,{name:"associatedRecipes",control:u,render:({field:y})=>e.jsx(at,{...y,selected:y.value,filterBy:b,id:`${t}associatedRecipes`,multiple:!0,onSearch:x,options:l,placeholder:"Vyberte recept...",isLoading:n,searchText:"Vyhľadávam...",promptText:"Prosím zadajte vyhľadávaný text.",emptyLabel:"Nič sa nenašlo.",labelKey:"name",isInvalid:!!k})}),e.jsx(g.Control.Feedback,{type:"invalid",children:k==null?void 0:k.toString()})]}),e.jsx(B,{show:!!s,message:s,type:"error",onClose:()=>{o(void 0)}}),e.jsx(ne,{show:n})]})},pt=E({name:O().trim().min(1,"Povinná položka").max(80,"Musí byť maximálne 80 znakov").required(),description:O().defined().trim().transform(t=>t===""?null:t).max(160,"Musí byť maximálne 160 znakov").default(null).nullable(),serves:L().transform(t=>/\b([1-9]|[1-9][0-9]|100)\b/.test(t)?t:null).integer().defined().min(1,"Musí byť minimálne 1 porcia alebo porciu nedefinovať").max(100,"Musí byť maximálne 100").default(null).nullable(),method:O().defined().trim().transform(t=>t===""?null:t).default(null).nullable(),sources:M().of(E({value:O().trim().max(1e3,"Musí byť maximálne 1000 znakov").required()})).required(),categoryId:L().integer().min(1,"Prosím vyberte možnosť").required(),recipeSections:M().of(E({name:O().defined().trim().transform(t=>t===""?null:t).max(80,"Musí byť maximálne 80 znakov").default(null).nullable(),method:O().defined().trim().transform(t=>t===""?null:t).default(null).nullable(),ingredients:M().of(E({name:O().trim().max(80,"Musí byť maximálne 80 znakov").required("Povinná položka"),value:L().defined().min(0,"Hodnota musí byť minimálne 0").default(null).nullable().transform(t=>isNaN(t)?null:t),unitId:L().integer().min(1,"Povinná položka").required(),sortNumber:L().defined().default(0).label("Poradové číslo")})).required(),sortNumber:L().defined().default(0).label("Poradové číslo")})).required(),associatedRecipes:M().defined().transform(t=>t===null?[]:t).of(E({id:L().integer().min(1).required(),name:O().trim().min(1,"Povinná položka").max(80,"Musí byť maximálne 80 znakov").required()})).required(),tags:M().of(E({id:L().integer().min(1).required(),name:O().trim().min(1,"Povinná položka").max(80,"Musí byť maximálne 80 znakov").required()}).required()).required(),pictures:M().of(E({id:L().integer().min(1).required(),name:O().trim().min(1,"Povinná položka").max(80,"Musí byť maximálne 80 znakov").required(),sortNumber:L().defined().default(0).label("Poradové číslo")})).transform(t=>t===""?[]:t).required()}).required(),bt={name:"",description:null,serves:null,method:null,sources:[],recipeSections:[{name:"",sortNumber:1,method:null,ingredients:[{name:"",sortNumber:1,value:null,unitId:-1}]}],tags:[],associatedRecipes:[],categoryId:-1,pictures:[]},yt=()=>{const[t,n]=r.useState(),[a,s]=r.useState([]),[o,l]=r.useState([]),[d,c]=r.useState([]),[u,p]=r.useState([]),[x,k]=r.useState(),[b,f]=r.useState(!1),y=Ee(),i=J(),m=Ke(),{search:w}=Ue(),q=new URLSearchParams(w),T=r.useId(),z=Me({resolver:Ge(pt),defaultValues:async()=>{try{const h=[],j=[],C=await i.fetchQuery({queryKey:["categories"],queryFn:({signal:I})=>Ae.getCategories({signal:I}).then(R=>[...R].sort((v,_)=>v.name.localeCompare(_.name,void 0,{sensitivity:"base"})))}),U=await i.fetchQuery({queryKey:["tags"],queryFn:({signal:I})=>Ve.getTags({signal:I}).then(R=>[...R].sort((v,_)=>v.name.localeCompare(_.name,void 0,{sensitivity:"base"})))}),F=await i.fetchQuery({queryKey:["unitcategories"],queryFn:({signal:I})=>Be.getUnitCategories({signal:I}).then(R=>[...R].sort((v,_)=>v.name.localeCompare(_.name,void 0,{sensitivity:"base"})))});for(const I of F){const R=await i.fetchQuery({queryKey:["unitcategories",I.id,"units"],queryFn:async({queryKey:v})=>(await He.getUnitsByUnitCategory(v[1])).sort((Ne,Ie)=>Ne.name.localeCompare(Ie.name,void 0,{sensitivity:"base"}))});R.forEach(v=>{j.push({id:v.id,required:v.required})}),h.push({optGroupId:I.id,optGroupName:I.name,options:R.map(v=>({value:v.id,label:v.name}))})}if(l(C),c(U),p(j),s(h),m.recipeId){const I=await i.fetchQuery({queryKey:["recipes",+(m==null?void 0:m.recipeId)],queryFn:async({queryKey:v,signal:_})=>G.getRecipe(v[1],{signal:_})}),R={...I,sources:I.sources.map(v=>({value:v})),associatedRecipes:I.associatedRecipes.map(v=>({id:v.id,name:v.name}))};return k(R.name),R}}catch(h){A(h).then(j=>n(j))}return bt}}),{formState:{isSubmitting:S,isLoading:N},control:X}=z,fe=()=>{y(`/recipes?${q}`)},{mutate:ve,isPending:xe}=Y({mutationFn:async({data:h,recipeId:j})=>j?(await G.updateRecipe(j,h),{id:j}):G.createRecipe(h),onMutate:async()=>{await i.cancelQueries({queryKey:["recipes"]}),i.removeQueries({queryKey:["find"]})},onSettled:(h,j)=>{j?A(j).then(C=>n(C)):h&&(i.removeQueries({queryKey:["recipes",h.id]}),y(`/recipes?${q}`))}}),je=async h=>{const j={...h,tags:h.tags.map(C=>C.id),sources:h.sources.map(C=>C.value),associatedRecipes:h.associatedRecipes.map(C=>C.id),recipeSections:h.recipeSections.map((C,U)=>({...C,sortNumber:U+1,id:"id"in C&&C.id?C.id:void 0,ingredients:C.ingredients.map((F,I)=>{if(F.value===null){const R=u.find(v=>v.id===F.unitId);if(R!=null&&R.required)throw z.setError(`recipeSections.${U}.ingredients.${I}.value`,{type:"required",message:"Pri danej jednotke musí byť zadané množstvo."}),new Error("chyba validacie")}return{...F,sortNumber:I+1,id:"id"in F&&F.id?F.id:void 0}})}))};ve({data:j,recipeId:m.recipeId?+m.recipeId:void 0})},Ce=r.useCallback(()=>{f(!0)},[]),{mutate:re,isPending:ke}=Y({mutationFn:h=>G.deleteRecipe(h),onMutate:async()=>{await i.cancelQueries({queryKey:["recipes"]}),i.removeQueries({queryKey:["find"]})},onSettled:(h,j,C)=>{j?A(j).then(U=>n(U)):C&&(i.removeQueries({queryKey:["recipes",C]}),q.set("page",`${Ze}`),y(`/recipes?${q}`))}}),Se=r.useCallback(h=>{h&&(m.recipeId?re(+m.recipeId):n("Neplatné používateľské ID!")),f(!1)},[re,m.recipeId]);return e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-lg-12 pt-3",children:[e.jsx("h1",{children:m.recipeId?"Zmena receptu":"Pridanie receptu"}),e.jsx(Qe,{...z,children:e.jsxs(g,{onSubmit:z.handleSubmit(je),noValidate:!0,autoComplete:"off",children:[e.jsx(V,{name:"name",label:"Názov"}),e.jsx(ee,{name:"description",label:"Popis"}),e.jsx(V,{name:"serves",label:"Počet porcií",type:"number",min:1}),e.jsx(it,{units:a}),e.jsx(ee,{label:"Postup prípravy receptu (voliteľné)",name:"method",rows:10}),e.jsx(nt,{name:"categoryId",label:"Kategória receptu",multiple:!1,options:o.map(h=>({value:h.id,label:h.name}))??[]}),o.length===0&&e.jsx("p",{className:"text-danger",children:"Nie je možné vybrať žiadnu kategóriu, nakoľko žiadna nie je zadefinovaná."}),e.jsx(mt,{}),e.jsxs(g.Group,{className:"mb-3",children:[e.jsx(g.Label,{htmlFor:"tagsMultiselection",children:"Značky"}),e.jsx(he,{control:X,name:"tags",render:({field:{onChange:h,value:j}})=>e.jsx(me,{id:T+"tags",labelKey:"name",onChange:h,options:d??[],placeholder:"Vyberte ľubovoľný počet značiek",selected:j,multiple:!0})}),d.length===0&&e.jsx("p",{className:"text-danger",children:"Nie je možné vybrať žiadnu značku, nakoľko žiadna nie je zadefinovaná."})]}),e.jsx(ct,{}),e.jsx(dt,{}),e.jsxs(Z,{gap:2,className:"flex-md-row",children:[e.jsx($,{variant:"primary",type:"submit",children:m.recipeId?"Zmeniť recept":"Pridať recept"}),e.jsx($,{variant:"warning",type:"button",onClick:fe,children:"Zrušiť"}),e.jsx("div",{className:"flex-grow-1 d-none d-md-block"}),m.recipeId&&e.jsx($,{variant:"danger",type:"button",onClick:Ce,children:"Vymazať recept"})]})]})})]}),e.jsx(ne,{show:S||N||xe||ke}),e.jsx(B,{show:!!b,type:"question",message:`Prajete si vymazať recept "${x}" ?`,onClose:Se}),e.jsx(B,{show:!!t,message:t,type:"error",onClose:()=>{n(void 0)}})]})};export{yt as default};
//# sourceMappingURL=RecipeEditPage-BH76OdRY.js.map
