import{r as S,u as M,y as q,e as w,n as C,j as t,p as F,o as I,I as P,S as Q,B as v,M as U,d as z,s as E,m as l,f as p,v as N,x as K}from"./index-Djf207zA.js";import{u as V}from"./useMutation-CYG_XA4X.js";const B=N({name:K().trim().min(1,"Musí byť minimálne 1 znak").max(80,"Musí byť maximálne 80 znakov").required("Povinná položka")}).required(),Z=()=>{const[d,o]=S.useState(),y=M(),a=q(),i=w(),u=C({resolver:E(B),defaultValues:async()=>{if(a.id)try{return await i.fetchQuery({queryKey:["unitcategories",parseInt(a==null?void 0:a.id)],queryFn:({queryKey:n,signal:s})=>l.getUnitCategory(n[1],{signal:s})})}catch(e){p(e).then(n=>o(n))}return{name:""}}}),{formState:{isSubmitting:x,isLoading:h}}=u,j=()=>{y("/units")},{mutate:f,isPending:b}=V({mutationFn:({data:e,unitCategoryId:n})=>n?l.updateUnitCategory(n,e):l.createUnitCategory(e),onMutate:async()=>{await i.cancelQueries({queryKey:["unitcategories"]})},onSettled:async(e,n)=>{n?p(n).then(s=>o(s)):e&&(i.setQueryData(["unitcategories",e.id],()=>e),i.setQueryData(["unitcategories"],s=>{const g=(s==null?void 0:s.findIndex(r=>r.id===e.id))??-1;if(g>-1){const r=[...s??[]];return r[g]={id:e.id,name:e.name},r.sort((c,m)=>c.name.localeCompare(m.name,void 0,{sensitivity:"base"}))}else return[...s??[],{id:e.id,name:e.name}].sort((c,m)=>c.name.localeCompare(m.name,void 0,{sensitivity:"base"}))}),y("/units"))}}),k=e=>{f({data:e,unitCategoryId:a.id?parseInt(a.id):void 0})};return t.jsxs("div",{className:"row justify-content-center",children:[t.jsxs("div",{className:"col-lg-6 pt-3",children:[t.jsx("h1",{children:"Kategória jednotiek"}),t.jsx(F,{...u,children:t.jsxs(I,{noValidate:!0,onSubmit:u.handleSubmit(k),children:[t.jsx(P,{name:"name",label:"Názov kategórie jednotiek"}),t.jsxs(Q,{direction:"horizontal",gap:2,children:[t.jsx(v,{variant:"primary",type:"submit",children:a.id?"Zmeniť kategóriu":"Vytvoriť kategóriu"})," ",t.jsx(v,{variant:"warning",type:"button",onClick:j,children:"Zrušiť"})]})]})})]}),t.jsx(U,{show:!!d,message:d,type:"error",onClose:()=>{o(void 0)}}),t.jsx(z,{show:x||h||b})]})};export{Z as default};
//# sourceMappingURL=UnitCategoryPage-DUv6ZBKx.js.map
