import{r as i,u as F,y as H,n as L,a as c,g as O,f as w,Q as T,j as e,p as V,o as p,I as l,a2 as Z,T as D,k as b,C as B,S as W,B as v,M as P,d as G,s as K,v as z,w as Q,a6 as J,x as r,a8 as X,a9 as Y}from"./index-Djf207zA.js";const _=[{value:b.User.RoleEnum.ADMIN,name:"Administrátor"},{value:b.User.RoleEnum.CREATOR,name:"Tvorca obsahu"}],ee=z({username:r().trim().min(4,"Musia byť minimálne 4 znaky").max(50,"Musí byť maximálne 50 znakov").matches(/^[a-z0-9]+/,"Musí obsahovať iba malé písmená a čísla").required("Povinná položka"),firstName:r().defined().trim().transform(n=>n===""?null:n).min(3,"Musia byť minimálne 3 znaky").max(50,"Musí byť maximálne 50 znakov").default(null).nullable(),lastName:r().defined().trim().transform(n=>n===""?null:n).min(3,"Musia byť minimálne 3 znaky").max(50,"Musí byť maximálne 50 znakov").default(null).nullable(),email:r().trim().max(320,"Musí mať maximálne 320 znakov").required("Povinná položka"),password:r().trim().defined().min(8,"Musí byť minimálne 8 znakov").max(255,"Musí byť maximálne 255 znakov").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})/,"Musí obsahovať aspoň jedno malé písmeno, jedno veľké písmeno a jedno číslo").nullable(),confirmPassword:r().trim().equals([Y("password")],"Zadané heslá sa nezhodujú").required("Povinná položka"),roles:J().defined().of(z({value:X().defined().oneOf(Object.values(b.CreateUser.RoleEnum)),name:r().defined()})).min(1,"Musí byť minimálne jedna rola").required(),notifications:Q().required("Povinná položka")}).required(),se=()=>{var k;const n=i.useId(),[x,f]=i.useState(),[M,h]=i.useState(!1),[C,S]=i.useState(!1),[E,j]=i.useState(!1),y=F(),a=H(),m=L({resolver:K(ee),defaultValues:{roles:[]}}),{formState:{isSubmitting:I,errors:N},control:U}=m;i.useEffect(()=>{if(a.id){const o=new AbortController,t=a==null?void 0:a.id;return(async()=>{try{h(!0);const s=await c.getUser(parseInt(t),{signal:o.signal});S(s.confirmed);const d=s.roles.map(g=>({value:g,name:O[g]})),$={...s,password:"",confirmPassword:"",roles:d};m.reset($)}catch(s){w(s).then(d=>f(d))}finally{h(!1)}})(),()=>o.abort()}},[a.id,m]);const q=()=>{y("/users")},R=async()=>{a.id&&(await c.resendConfirmation(+a.id),j(!0))},A=async o=>{const t={...o,roles:o.roles.map(s=>s.value)};try{a.id?await c.updateUser(parseInt(a.id),t):await c.createUser(t),y("/users")}catch(s){w(s).then(d=>f(d))}},u=(k=T.get(N,"roles"))==null?void 0:k.message;return e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-lg-6 pt-3",children:[e.jsx("h1",{children:"Používateľ"}),e.jsx(V,{...m,children:e.jsxs(p,{noValidate:!0,onSubmit:m.handleSubmit(A),children:[e.jsx(l,{name:"username",label:"Používateľské meno"}),e.jsx(l,{name:"firstName",label:"Meno"}),e.jsx(l,{name:"lastName",label:"Priezvisko"}),e.jsx(l,{name:"email",label:"E-mail"}),e.jsx(l,{name:"password",label:"Heslo"}),e.jsx(l,{name:"confirmPassword",label:"Potvrdenie hesla"}),e.jsxs(p.Group,{className:"mb-3",children:[e.jsx(p.Label,{htmlFor:"tagsMultiselection",children:"Používateľské role"}),e.jsx(Z,{control:U,name:"roles",render:({field:{onChange:o,value:t}})=>e.jsx(D,{id:n+"roles",labelKey:"name",onChange:o,options:_,placeholder:"Vyberte ľubovoľný počet rolí",selected:t,isInvalid:!!u,multiple:!0})}),e.jsx(p.Control.Feedback,{type:"invalid",children:u==null?void 0:u.toString()})]}),e.jsx(B,{name:"notifications",label:"Posielať notifikácie e-mailom"}),e.jsxs(W,{direction:"horizontal",gap:2,children:[e.jsx(v,{variant:"primary",type:"submit",children:a.id?"Zmeniť používateľa":"Vytvoriť používateľa"})," ",!C&&e.jsx(v,{variant:"secondary",type:"button",onClick:R,children:"Poslať potvrdzujúci e-mail"}),e.jsx(v,{variant:"warning",type:"button",onClick:q,children:"Zrušiť"})]})]})})]}),e.jsx(P,{show:!!x,message:x,type:"error",onClose:()=>{f(void 0)}}),e.jsx(P,{show:E,message:"Potvrdzujúci e-mail bol zaslaný používateľovi.",type:"info",onClose:()=>{j(!1)}}),e.jsx(G,{show:I||M})]})};export{se as default};
//# sourceMappingURL=UserPage-DbE4918n.js.map
