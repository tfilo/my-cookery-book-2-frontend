import{r as o,A as P,n as N,a as k,f,j as e,o as t,p as S,I as l,C as A,B as E,F as I,q,M as j,d as F,s as L,v as U,w as H,x as r}from"./index-Djf207zA.js";const Z=U({password:r().trim().max(255,"Musí byť maximálne 255 znakov").required("Povinná položka"),newPassword:r().trim().transform(a=>a===""?null:a).min(8,"Musí byť minimálne 8 znakov").max(255,"Musí byť maximálne 255 znakov").matches(/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.{8,})/,"Musí obsahovať aspoň jedno malé písmeno, jedno veľke písmeno a jedno číslo").default(null).nullable(),firstName:r().trim().transform(a=>a===""?null:a).min(3,"Musí mať minimálne 3 znaky").max(50,"Musí mať maximálne 50 znakov").default(null).nullable(),lastName:r().trim().transform(a=>a===""?null:a).min(3,"Musí mať minimálne 3 znaky").max(50,"Musí mať maximálne 50 znakov").default(null).nullable(),email:r().trim().max(320,"Musí mať maximálne 320 znakov").required("Povinná položka"),notifications:H().required("Povinná položka")}).required(),V=()=>{const[a,i]=o.useState(),[b,c]=o.useState(!1),{isLoggedIn:d,hasCookieConsent:v,setHasCookieConsent:p}=o.useContext(P),[y,w]=o.useState(""),[C,h]=o.useState(!1),m=N({resolver:L(Z)}),{formState:{isSubmitting:g},reset:x}=m,z=o.useCallback(n=>{p(n.target.checked)},[p]),M=async n=>{try{await k.updateProfile(n),c(!0)}catch(s){s instanceof Response&&s.statusText==="Unauthorized"?i("Zadané heslo nebolo platné"):f(s).then(u=>i(u))}};return o.useEffect(()=>{if(d){const n=new AbortController;return(async()=>{try{h(!0);const s=await k.getProfile({signal:n.signal});x(s),w(s.username)}catch(s){f(s).then(u=>i(u))}finally{h(!1)}})(),()=>n.abort()}},[d,x]),e.jsxs("div",{className:"row justify-content-center",children:[e.jsxs("div",{className:"col-lg-6 pt-3",children:[e.jsx("h1",{children:"Profil používateľa"}),e.jsxs(t.Group,{className:"mb-3",children:[e.jsx(t.Label,{children:"Používateľské meno"}),e.jsx(t.Control,{type:"text",value:y??"",readOnly:!0})]}),e.jsx(S,{...m,children:e.jsxs(t,{onSubmit:m.handleSubmit(M),noValidate:!0,className:"pb-4",children:[e.jsx(l,{name:"firstName",label:"Meno",type:"text"}),e.jsx(l,{name:"lastName",label:"Priezvisko",type:"text"}),e.jsx(l,{name:"email",label:"E-mail",type:"email"}),e.jsx(l,{name:"password",label:"Heslo",type:"password"}),e.jsx(l,{name:"newPassword",label:"Nové heslo",type:"password"}),e.jsx(A,{name:"notifications",label:"Posielať notifikácie e-mailom"}),e.jsx(E,{variant:"primary",type:"submit",children:"Zmeniť"})]})}),e.jsxs("h2",{children:[e.jsx(I,{icon:q})," Nastavenia cookies"]}),e.jsx("p",{children:'Udelením súhlasu umožníte aplikácií ukladať informácie do lokálneho úložiska (localStorage) prehliadača. Aplikácia po udelení súhlasu umožňuje zapamätať si práve prihláseného používateľa. Vďaka tomu sa nebudete musieť pri opätovnej návšteve prihlasovať. Lokálne úložisko sa zároveň môže používať na uloženie "záložiek" na recepty. Uložené záložky sa viažú na prehliadač a nie používateľské konto. Po odhlásení budú tieto údaje odstránené.'}),e.jsx("p",{children:"Informácia o udelenom súhlase sa ukladá do cookies prehliadača a je platná na 1 rok od udelenia súhlasu."}),e.jsx("h3",{children:"Vaše preferencie cookies"}),e.jsx(t.Group,{className:"mb-3",children:e.jsx(t.Check,{type:"switch",label:"Udelenie súhlasu",checked:v,onChange:z})})]}),e.jsx(j,{show:!!a,message:a,type:"error",onClose:()=>{i(void 0)}}),e.jsx(j,{show:b,message:"Zmena profilu bola úspešná.",type:"info",onClose:()=>{c(!1)}}),e.jsx(F,{show:g||C})]})};export{V as default};
//# sourceMappingURL=ProfilePage-BmT3hAHI.js.map
