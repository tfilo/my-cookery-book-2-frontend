import{r as k,u as M,y as q,e as w,n as C,j as s,p as z,o as F,I,S as P,B as v,M as Q,d as T,s as E,t as l,f as x,v as Z,x as N}from"./index-Djf207zA.js";import{u as V}from"./useMutation-CYG_XA4X.js";const B=Z({name:N().trim().min(1,"Musí byť minimálne 1 znak").max(80,"Musí byť maximálne 80 znakov").required("Povinná položka")}).required(),K=()=>{const[d,o]=k.useState(),y=M(),t=q(),i=w(),u=C({resolver:E(B),defaultValues:async()=>{if(t.id)try{return await i.fetchQuery({queryKey:["tags",parseInt(t==null?void 0:t.id)],queryFn:({queryKey:n,signal:a})=>l.getTag(n[1],{signal:a})})}catch(e){x(e).then(n=>o(n))}return{name:""}}}),{formState:{isSubmitting:g,isLoading:h}}=u,f=()=>{y("/tags")},{mutate:j,isPending:b}=V({mutationFn:({data:e,tagId:n})=>n?l.updateTag(n,e):l.createTag(e),onMutate:async()=>{await i.cancelQueries({queryKey:["tags"]})},onSettled:async(e,n)=>{n?x(n).then(a=>o(a)):e&&(i.setQueryData(["tags",e.id],()=>e),i.setQueryData(["tags"],a=>{const p=(a==null?void 0:a.findIndex(r=>r.id===e.id))??-1;if(p>-1){const r=[...a??[]];return r[p]={id:e.id,name:e.name},r.sort((c,m)=>c.name.localeCompare(m.name,void 0,{sensitivity:"base"}))}else return[...a??[],{id:e.id,name:e.name}].sort((c,m)=>c.name.localeCompare(m.name,void 0,{sensitivity:"base"}))}),y("/tags"))}}),S=e=>{j({data:e,tagId:t.id?parseInt(t.id):void 0})};return s.jsxs("div",{className:"row justify-content-center",children:[s.jsxs("div",{className:"col-lg-6 pt-3",children:[s.jsx("h1",{children:"Značka"}),s.jsx(z,{...u,children:s.jsxs(F,{noValidate:!0,onSubmit:u.handleSubmit(S),children:[s.jsx(I,{name:"name",label:"Značka"}),s.jsxs(P,{direction:"horizontal",gap:2,children:[s.jsx(v,{variant:"primary",type:"submit",children:t.id?"Zmeniť značku":"Vytvoriť značku"})," ",s.jsx(v,{variant:"warning",type:"button",onClick:f,children:"Zrušiť"})]})]})})]}),s.jsx(Q,{show:!!d,message:d,type:"error",onClose:()=>{o(void 0)}}),s.jsx(T,{show:g||h||b})]})};export{K as default};
//# sourceMappingURL=TagPage-BKS8dvdq.js.map
