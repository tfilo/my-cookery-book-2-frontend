import{r as S,u as k,y as M,e as q,n as w,j as t,p as F,o as I,I as P,S as Q,B as p,M as z,d as E,s as K,z as l,f as v,v as N,x as V}from"./index-Djf207zA.js";import{u as B}from"./useMutation-CYG_XA4X.js";const D=N({name:V().trim().min(1,"Musí byť minimálne 1 znak").max(50,"Musí byť maximálne 50 znakov").required("Povinná položka")}).required(),$=()=>{const[d,o]=S.useState(),y=k(),n=M(),i=q(),u=w({resolver:K(D),defaultValues:async()=>{if(n.id)try{return await i.fetchQuery({queryKey:["categories",parseInt(n==null?void 0:n.id)],queryFn:({queryKey:s,signal:a})=>l.getCategory(s[1],{signal:a})})}catch(e){v(e).then(s=>o(s))}return{name:""}}}),{formState:{isSubmitting:x,isLoading:h}}=u,f=()=>{y("/categories")},{mutate:j,isPending:b}=B({mutationFn:({data:e,categoryId:s})=>s?l.updateCategory(s,e):l.createCategory(e),onMutate:async()=>{await i.cancelQueries({queryKey:["categories"]})},onSettled:async(e,s)=>{s?v(s).then(a=>o(a)):e&&(i.setQueryData(["categories",e.id],()=>e),i.setQueryData(["categories"],a=>{const g=(a==null?void 0:a.findIndex(r=>r.id===e.id))??-1;if(g>-1){const r=[...a??[]];return r[g]={id:e.id,name:e.name},r.sort((c,m)=>c.name.localeCompare(m.name,void 0,{sensitivity:"base"}))}else return[...a??[],{id:e.id,name:e.name}].sort((c,m)=>c.name.localeCompare(m.name,void 0,{sensitivity:"base"}))}),y("/categories"))}}),C=e=>{j({data:e,categoryId:n.id?parseInt(n.id):void 0})};return t.jsxs("div",{className:"row justify-content-center",children:[t.jsxs("div",{className:"col-lg-6 pt-3",children:[t.jsx("h1",{children:"Kategória"}),t.jsx(F,{...u,children:t.jsxs(I,{noValidate:!0,onSubmit:u.handleSubmit(C),children:[t.jsx(P,{name:"name",label:"Kategória"}),t.jsxs(Q,{direction:"horizontal",gap:2,children:[t.jsx(p,{variant:"primary",type:"submit",children:n.id?"Zmeniť kategóriu":"Vytvoriť kategóriu"})," ",t.jsx(p,{variant:"warning",type:"button",onClick:f,children:"Zrušiť"})]})]})})]}),t.jsx(z,{show:!!d,message:d,type:"error",onClose:()=>{o(void 0)}}),t.jsx(E,{show:x||h||b})]})};export{$ as default};
//# sourceMappingURL=CategoryPage-KHhpS4X6.js.map
