{"version":3,"file":"UsersPage-Bfu_Mlek.js","sources":["../../src/pages/users/UsersPage.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Button, Stack, Table } from 'react-bootstrap';\nimport { faPencil, faTrash } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { Api } from '../../openapi';\nimport { userApi } from '../../utils/apiWrapper';\nimport { formatErrorMessage } from '../../utils/errorMessages';\nimport { getRoleLabel } from '../../localisations/localisations';\nimport Modal from '../../components/ui/Modal';\nimport Spinner from '../../components/ui/Spinner';\n\nconst UsersPage: React.FC = () => {\n    const [listOfUsers, setListOfUsers] = useState<Api.SimpleUser[]>([]);\n    const [error, setError] = useState<string>();\n    const [isLoading, setIsLoading] = useState<boolean>(false);\n    const [user, setUser] = useState<Api.SimpleUser>();\n    const navigate = useNavigate();\n\n    useEffect(() => {\n        const controller = new AbortController();\n        (async () => {\n            try {\n                setIsLoading(true);\n                const users = await userApi.getUsers({ signal: controller.signal });\n                setListOfUsers(users);\n            } catch (err) {\n                formatErrorMessage(err).then((message) => setError(message));\n            } finally {\n                setIsLoading(false);\n            }\n        })();\n        return () => controller.abort();\n    }, []);\n\n    const createUserHandler = () => {\n        navigate('/user');\n    };\n\n    const editUserHandler = (id: number) => {\n        navigate(`/user/${id}`);\n    };\n\n    const deleteUserHandler = (user: Api.SimpleUser) => {\n        setUser(user);\n    };\n\n    const deleteUserConfirmHandler = (status: boolean) => {\n        (async () => {\n            if (status === true) {\n                if (user) {\n                    try {\n                        setIsLoading(true);\n                        await userApi.deleteUser(user.id);\n                        setListOfUsers((prev) => {\n                            return prev.filter((_user) => _user.id !== user.id);\n                        });\n                    } catch (err) {\n                        formatErrorMessage(err).then((message) => {\n                            setError(message);\n                        });\n                    } finally {\n                        setIsLoading(false);\n                    }\n                } else {\n                    setError('Neplatné používateľské ID!');\n                }\n            }\n            setUser(undefined);\n        })();\n    };\n\n    return (\n        <>\n            <div className='d-flex flex-column flex-md-row'>\n                <h1 className='flex-grow-1'>Používatelia</h1>\n                <Button\n                    variant='primary'\n                    onClick={createUserHandler}\n                >\n                    Pridať používateľa\n                </Button>\n            </div>\n            <Table\n                striped\n                responsive\n            >\n                <thead>\n                    <tr>\n                        <th>Používateľské meno</th>\n                        <th>Meno</th>\n                        <th>Priezvisko</th>\n                        <th>Rola</th>\n                        <th></th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {listOfUsers.map((user) => (\n                        <tr key={user.id}>\n                            <td className='align-middle'>{user.username}</td>\n                            <td className='align-middle'>{user.firstName}</td>\n                            <td className='align-middle'>{user.lastName}</td>\n                            <td className='align-middle'>\n                                {user.roles\n                                    .map((role) => {\n                                        return getRoleLabel[role];\n                                    })\n                                    .join(', ')}\n                            </td>\n                            <td className='align-middle '>\n                                <Stack\n                                    direction='horizontal'\n                                    gap={2}\n                                    className='justify-content-end'\n                                >\n                                    <Button\n                                        title='Upraviť'\n                                        aria-label='Upraviť'\n                                        variant='outline-secondary'\n                                        onClick={editUserHandler.bind(null, user.id)}\n                                        className='border-0'\n                                    >\n                                        <FontAwesomeIcon icon={faPencil} />\n                                    </Button>\n                                    <Button\n                                        title='Vymazať'\n                                        aria-label='Vymazať'\n                                        variant='outline-danger'\n                                        onClick={deleteUserHandler.bind(null, user)}\n                                        className='border-0'\n                                    >\n                                        <FontAwesomeIcon icon={faTrash} />\n                                    </Button>\n                                </Stack>\n                            </td>\n                        </tr>\n                    ))}\n                </tbody>\n            </Table>\n            <Modal\n                show={!!user}\n                type='question'\n                message={`Prajete si vymazať používateľa \"${user?.username}\" ?`}\n                onClose={deleteUserConfirmHandler}\n            />\n            <Modal\n                show={!!error}\n                message={error}\n                type='error'\n                onClose={() => {\n                    setError(undefined);\n                }}\n            />\n            <Spinner show={isLoading} />\n        </>\n    );\n};\n\nexport default UsersPage;\n"],"names":["UsersPage","listOfUsers","setListOfUsers","useState","error","setError","isLoading","setIsLoading","user","setUser","navigate","useNavigate","useEffect","controller","users","userApi","err","formatErrorMessage","message","createUserHandler","editUserHandler","id","deleteUserHandler","deleteUserConfirmHandler","status","prev","_user","jsxs","Fragment","jsx","Button","Table","role","getRoleLabel","Stack","FontAwesomeIcon","faPencil","faTrash","Modal","Spinner"],"mappings":"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"}